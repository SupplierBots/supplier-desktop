!function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=14)}([function(e,t){e.exports=require("electron")},function(e,t){e.exports=require("rxjs/operators")},function(e,t){e.exports=require("ramda")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("electron-better-ipc")},function(e,t){e.exports=require("electron-updater")},function(e,t){e.exports=require("puppeteer-extra")},function(e,t){e.exports=require("fs-extra")},function(e,t){e.exports=require("moment")},function(e,t){e.exports=require("rxjs")},function(e,t){e.exports=require("axios")},function(e,t){e.exports=require("puppeteer/DeviceDescriptors")},function(e,t){e.exports=require("puppeteer-extra-plugin-stealth")},function(e,t){e.exports=require("electron-devtools-installer")},function(e,t,i){"use strict";function r(e,t,i,r,n,o,s){try{var a=e[o](s),l=a.value}catch(e){return void i(e)}a.done?t(l):Promise.resolve(l).then(r,n)}function n(e){return function(){var t=this,i=arguments;return new Promise((function(n,o){var s=e.apply(t,i);function a(e){r(s,n,o,a,l,"next",e)}function l(e){r(s,n,o,a,l,"throw",e)}a(void 0)}))}}i.r(t);var o=i(0),s=i(3),a=i.n(s),l=i(4),c=i(7),u=i.n(c),p=i(6),d=i.n(p);const h="686378",y=function(){var e=n((function*(e){const t=o.app.getPath("userData"),i=a.a.resolve(t,".local-chromium");try{u.a.accessSync(i);const e=d.a.createBrowserFetcher({path:i});if((yield e.localRevisions()).length<1)return!1;const t=e.revisionInfo(h).executablePath,r=yield d.a.launch({executablePath:t,headless:!0}),n=yield r.newPage();return yield n.goto("http://example.com/"),yield r.close(),{success:!0,executablePath:t,version:o.app.getVersion()}}catch(e){return console.log("Error while testing browser."),console.log(e),u.a.removeSync(i),{success:!1,executablePath:"fail",version:o.app.getVersion()}}}));return function(t){return e.apply(this,arguments)}}(),f=e=>{const t=a.a.resolve(o.app.getPath("userData"),".local-chromium"),i=d.a.createBrowserFetcher({path:t});let r=0;i.download(h,function(){var e=n((function*(e,t){const i={progress:Math.round(e/t*100),done:e===t};(i.progress>r||i.done)&&(r=i.progress,null==ie||ie.webContents.send("CHROMIUM_DOWNLOAD_PROGRESS",i))}));return function(t,i){return e.apply(this,arguments)}}())};var g=i(11),m=i.n(g),b=i(12),v=i.n(b);var w=function(){var e=n((function*(e,t=0){ee.browserStateChange(e,!0);const i=o.app.getPath("userData"),r=d.a.createBrowserFetcher({path:a.a.resolve(i,".local-chromium")}).revisionInfo(h).executablePath,s=a.a.resolve(i,e),{width:l,height:c,deviceScaleFactor:u}=m.a["Pixel 2"].viewport;d.a.use(v()());const p=yield d.a.launch({headless:!1,ignoreHTTPSErrors:!0,ignoreDefaultArgs:["--enable-automation"],args:["--no-sandbox","--disable-gpu","--disable-infobars","--disable-setuid-sandbox","--disable-dev-shm-usage","--ignore-certifcate-errors","--ignore-certifcate-errors-spki-list",`--user-data-dir=${s}`,`--window-size=${l},${c+82}`,`--window-position=${0+500*t},0`],executablePath:r}),y=yield p.newPage(),f=yield y.target().createCDPSession();return p.on("targetcreated",e=>{e.url().includes("devtools")}),f.send("Network.setUserAgentOverride",{userAgent:"Mozilla/5.0 (Linux; Android 8.0; Pixel 2 Build/OPD3.170816.012) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3882.0 Mobile Safari/537.36",locale:"en-US,en",platform:"linux"}),yield Promise.all([f.send("Emulation.setDeviceMetricsOverride",{mobile:!0,width:l,height:c,deviceScaleFactor:u,screenOrientation:{angle:0,type:"portraitPrimary"}}),f.send("Emulation.setTouchEmulationEnabled",{enabled:!0}),f.send("Emulation.setEmitTouchEventsForMouse",{enabled:!0,configuration:"desktop"})]),y.on("close",n((function*(){yield p.close()}))),p.on("disconnected",n((function*(){ee.browserStateChange(e,!1)}))),p}));return function(t){return e.apply(this,arguments)}}();const k=function(){var e=n((function*(e,t){const i=e.browser();e?(yield e.goto("https://accounts.google.com/signin/v2/identifier?flowName=GlifWebSignIn&flowEntry=ServiceLogin&hl=en"),e.on("load",n((function*(){if(!e.url().includes("https://myaccount.google.com/"))return;yield e.waitForXPath("//div[contains(text(),'@gmail.com')]");const r=yield e.$x("//div[contains(text(),'@gmail.com')]");if(r.length<1)return;const[n]=r,o=yield n.getProperty("innerText");let s=yield o.jsonValue();const a=yield ee.getSameEmails(s);a&&a.length>0&&(s+=` (${a.length+1})`),ee.setBrowserEmail(t,s),i.close()})))):i.close()}));return function(t,i){return e.apply(this,arguments)}}();var S=i(2),O=i(10),P=i.n(O),C=i(9),T=i(1);class E{constructor(){}static init(e){this.unsubscribeAll(),this.subscriptions=[];const t=Object(C.timer)(0,e).pipe(Object(T.switchMap)(()=>P.a.get("https://www.supremenewyork.com/shop.json",{transformResponse:e=>e})),Object(T.pluck)("data"),Object(T.retryWhen)(t=>t.pipe(Object(T.delay)(e)))),i=Object(C.timer)(e/2,e).pipe(Object(T.switchMap)(()=>P.a.get("https://www.supremenewyork.com/mobile_stock.json",{transformResponse:e=>e})),Object(T.pluck)("data"),Object(T.retryWhen)(t=>t.pipe(Object(T.delay)(e))));this.observable=Object(C.merge)(t,i).pipe(Object(T.distinctUntilChanged)(),Object(T.map)(e=>{const t=JSON.parse(e);if(t.error||!t.products_and_categories)throw new Error("Invalid response");return t}),Object(T.retryWhen)(t=>t.pipe(Object(T.delay)(e))),Object(T.shareReplay)({refCount:!0}))}static subscribe(e){const t=this.observable.subscribe(e);return this.subscriptions.push(t),t}static unsubscribeAll(){this.subscriptions.forEach(e=>e.unsubscribe())}}function x(e,t){return A.apply(this,arguments)}function A(){return(A=n((function*(e,t){const i=e.postData();if(t.logger.reportRequest(e),"http://127.0.0.1:2140/status.json"!==e.url()||!i)return;const r=JSON.parse(i);if("ATC"===r.message)return yield t.checkout();ee.updateTaskStatus(t.task,r),"Sold out"===r.message&&(yield t.page.close(),yield t.page.browser().close())}))).apply(this,arguments)}let j;function D(e,t){return _.apply(this,arguments)}function _(){return(_=n((function*(e,t){const i=e.status(),r=e.url();if(t.logger.reportResponse(e),/.*checkout.json$/.test(r)&&200!==i)return t.updateTaskStatus({message:`${i}. Retrying`,type:j.Error}),void(yield t.retry());if(200===i)if(/.*add.json$/.test(r)){const i=yield e.json();i.length>0?t.updateTaskStatus({message:"Added to cart",type:j.Action}):0===i.length&&(t.updateTaskStatus({message:"Size sold out",type:j.Error}),yield t.retry())}else if(/.*(checkout|status).json$/.test(r)){const i=yield e.json();switch(i.status){case"failed":case"404":case"500":case"outOfStock":{const e="outOfStock"===i.status?"Size sold out":"Failed. Retrying";return t.updateTaskStatus({message:e,type:j.Error}),void(yield t.retry())}case"queued":return void t.updateTaskStatus({message:"Processing",type:j.Action});case"dup":return t.updateTaskStatus({message:"Duplicate order",type:j.Error}),yield t.page.close(),void(yield t.browser.close());case"paid":return t.updateTaskStatus({message:"Success",type:j.Success,additionalInfo:i.id}),yield t.page.close(),void(yield t.browser.close())}}}))).apply(this,arguments)}function $(e,t){return R.apply(this,arguments)}function R(){return(R=n((function*(e,t=!0){yield this.page.waitForXPath(e,{visible:!0});const i=yield this.page.$x(e);let r=[];for(let e of i){const i=yield e.boundingBox(),n=yield e.isIntersectingViewport();null!==i&&n&&r.push(e),null===i||t||r.push(e)}return r[0]}))).apply(this,arguments)}function M({firstName:e,lastName:t,address1:i,address2:r,city:n,postcode:o,email:s,telephone:a}){return{name:"js-address",value:`${e} ${t}|${s}|${a}|${i}|${r}|${n}|undefined|${o}|PL|`.replace(/ /g,"%20").replace(/@/g,"%40"),domain:".supremenewyork.com"}}function I(e){return U.apply(this,arguments)}function U(){return(U=n((function*(){if(!this.profile)return;const e=yield this.page.cookies("https://www.supremenewyork.com/");yield this.page.deleteCookie(...e),yield this.page.setCookie(M(this.profile)),this.logger.writeObject({message:"Prepared cookies!"})}))).apply(this,arguments)}function L(e,t,i){return B.apply(this,arguments)}function B(){return(B=n((function*(e,t){yield this.page.waitForXPath(e,{visible:!0});const[i]=yield this.page.$x(e),r=yield i.getProperty("id"),n=yield r.jsonValue();yield this.page.select(`#${n}`,t)}))).apply(this,arguments)}E.observable=void 0,E.subscriptions=[],function(e){e.Inactive="Inactive",e.Action="Action",e.Success="Success",e.Error="Error"}(j||(j={}));const N=(e,t,i,r=!1,n=[])=>{let o=`//${e}[`;i=i.toLowerCase();for(let e of i)o+=` (contains(${t}, '${e}') or contains(${t}, '${e.toUpperCase()}')) and`;return o=o.slice(0,-4),n.forEach(e=>{e=e.toLowerCase(),o+=` and not(contains(${t}, '${e}')) and not(contains(${t}, '${e.toUpperCase()}'))`}),o+="]",r&&(o+="/parent::*"),o},q={addBtn:N("span","text()","add to",!1,["checkout","remove"]),addBtnDesktop:N("input","@value","add to",!1,["checkout","remove"]),checkoutBtn:N("span","text()","checkout",!0,["add","remove","basket"]),checkoutBtnDesktop:N("a","text()","checkout",!1,["add","remove","basket"]),cvv:N("input","@placeholder","cv",!1,["num","name"]),creditCardNumber:N("input","@placeholder","number",!1,["name","tel"]),termsLabel:N("label","text()","I have read")+"//preceding::input[@type='checkbox' and not(contains(@id, 'address'))]",processBtn:N("span","text()","process",!0,["cancel","edit"]),processBtnDesktop:N("input","@value","process",!1,["cancel","edit"])+"[@type='submit']",cardTypeSelect:"//option[contains(text(),'astercard')]/parent::*",monthSelect:"//option[contains(text(),'06')]/parent::*",yearSelect:"//option[contains(text(),'2021')]/parent::*",itemName:"//*[@class='name']",itemSelectable:"//*[@class='selectable']",price:"//*[@class='price']",recaptchaCSS:"*[name='g-recaptcha-response']"};function V(e){return W.apply(this,arguments)}function W(){return(W=n((function*(){var e,t,i;if(!(this.profile&&(null===(e=this.profile.month)||void 0===e?void 0:e.value)&&(null===(t=this.profile.year)||void 0===t?void 0:t.value)&&(null===(i=this.profile.creditCardType)||void 0===i?void 0:i.value)))return;const r=yield this.getVisibleElement(q.checkoutBtn);yield r.tap(),yield this.page.waitForXPath(q.cardTypeSelect,{visible:!0,timeout:0}),this.updateTaskStatus({message:"Checking out",type:j.Action});const n=Date.now(),{creditCardType:o,month:s,year:a,creditCardNumber:l,cvv:c}=this.profile;yield this.selectOption(q.cardTypeSelect,o.value),yield this.selectOption(q.monthSelect,s.value),yield this.selectOption(q.yearSelect,a.value);const u=yield this.getVisibleElement(q.creditCardNumber);yield u.tap(),yield u.type(l);const p=yield this.getVisibleElement(q.cvv);yield p.tap(),yield p.type(c.toString());const d=yield this.getVisibleElement(q.termsLabel,!1);yield d.tap();const h=Date.now()-n.valueOf(),y="string"==typeof this.task.checkoutDelay?parseInt(this.task.checkoutDelay):this.task.checkoutDelay;if(h<y){this.updateTaskStatus({message:"Checkout delay",type:j.Action});const e=y-h;yield new Promise(t=>setTimeout(t,e))}yield this.page.evaluate("(() => {\n        return new Promise((res, rej) => {\n            (function waitTicket() {\n                let cookieObj = {};\n                document.cookie.split(';').forEach(each => {\n                    if (each.includes('=')) cookieObj[each.split('=')[0].trim()] = each.split('=')[1].trim()\n                })\n                if (cookieObj['ticket'] && cookieObj['_ticket']) {\n                    if (parseInt(cookieObj['_ticket'].substr(cookieObj['_ticket'].length - 10)) > parseInt(cookieObj['ticket'].substr(cookieObj['ticket'].length - 10))) {\n                        try {\n                          document.querySelector('#mobile_checkout_form').setAttribute('data-credit_verified', 1);\n                        } catch {}\n                        res();\n                    } else {\n                        setTimeout(waitTicket, 100);\n                    }\n                } else {\n                    res();\n                }\n            })();\n        });\n    })();\n");const f=yield this.getVisibleElement(q.processBtn,!1);yield f.tap(),this.updateTaskStatus({message:"Waiting for response",type:j.Action})}))).apply(this,arguments)}function F(e){return X.apply(this,arguments)}function X(){return(X=n((function*(){this.updateTaskStatus({message:"Waiting for products",type:j.Action});try{yield this.page.goto("https://www.supremenewyork.com/mobile/",{timeout:3e3}),this.logger.writeString("Loaded main page!")}catch{return void(yield this.loadMainPage())}}))).apply(this,arguments)}var G=i(8),z=i.n(G);class H{constructor(e,t){var i=this;this.id=e,this.page=t,this.stream=void 0,this.reportRequest=e=>{e.url(),e.postData(),e.headers()["content-type"]},this.reportResponse=function(){var e=n((function*(e){e.url()}));return function(t){return e.apply(this,arguments)}}(),this.writeObject=function(){var e=n((function*(e,t=!0){if(e.time=z()().format("kk:mm:ss:SSS"),t){const t=yield i.page.cookies("https://www.supremenewyork.com/"),r=["_utm","js-address","mixpanel"];e.cookies=t.filter(({name:e})=>!r.some(t=>e.includes(t)))}try{i.stream.write("\n"+JSON.stringify(e,null,1))}catch{}}));return function(t){return e.apply(this,arguments)}}(),this.writeString=(e,t=!0)=>{this.writeObject({message:e},t)},this.stream=u.a.createWriteStream(`${o.app.getAppPath()}/logs/${this.id}${z()().format("-kk-mm-ss")}.log`)}}var J=class{constructor(e,t,i){var r=this;this.page=e,this.task=t,this.product=i,this.browser=void 0,this.checkoutDelay=void 0,this.externalStock=null,this.profile=null,this.logger=void 0,this.init=n((function*(){var e;E.subscribe(r.setStock),r.task.profile&&(r.profile=null!==(e=yield ee.getProfile(r.task.profile.value))&&void 0!==e?e:null,r.page.on("request",e=>r.parseRequest(e,r)),r.page.on("response",e=>r.parseResponse(e,r)),r.page.on("load",()=>r.onLoad()),r.logger.writeString("Started fast task!"),yield r.prepareCookies(),yield r.loadMainPage())})),this.onLoad=n((function*(){try{if(!(yield r.page.evaluate("window.location.href")).includes("#checkout")){const i=(e=r.product,t=r.externalStock,'(async()=>{localStorage.clear();if(typeof Supreme==="undefined")return await a();const o='+JSON.stringify(e)+";const p="+JSON.stringify(t)+String.fromCharCode(59,99,111,110,115,116,123,107,101,121,119,111,114,100,115,58,113,44,99,111,108,111,114,115,58,114,44,97,110,121,83,105,122,101,58,115,44,97,110,121,67,111,108,111,114,58,116,125,61,111,59,99,111,110,115,116,32,117,61,111,46,115,105,122,101,46,118,97,108,117,101,59,108,101,116,32,118,61,103,40,113,41,59,105,102,40,33,118,38,38,112,41,123,110,40,112,41,59,118,61,103,40,113,41,125,105,102,40,33,118,41,123,114,101,116,117,114,110,32,97,119,97,105,116,32,97,40,41,125,99,111,110,115,116,32,119,61,97,119,97,105,116,32,105,40,118,41,59,105,102,40,33,119,41,114,101,116,117,114,110,59,99,111,110,115,116,32,120,61,102,40,119,44,114,44,116,41,59,105,102,40,33,120,41,114,101,116,117,114,110,59,99,111,110,115,116,32,121,61,120,46,97,116,116,114,105,98,117,116,101,115,46,115,105,122,101,115,46,109,111,100,101,108,115,46,102,105,108,116,101,114,40,97,61,62,97,46,97,116,116,114,105,98,117,116,101,115,46,115,116,111,99,107,95,108,101,118,101,108,33,61,61,48,41,59,99,111,110,115,116,32,122,61,101,40,121,44,117,44,115,41,59,105,102,40,33,122,41,123,109,40,34,83,111,108,100,32,111,117,116,34,44,34,69,114,114,111,114,34,41,59,114,101,116,117,114,110,125,97,119,97,105,116,32,98,40,122,41,59,97,119,97,105,116,32,104,40,50,53,48,41,59,109,40,34,65,84,67,34,44,34,65,99,116,105,111,110,34,41,59,97,115,121,110,99,32,102,117,110,99,116,105,111,110,32,97,40,41,123,97,119,97,105,116,32,104,40,49,53,48,48,41,59,119,105,110,100,111,119,46,108,111,99,97,116,105,111,110,46,114,101,108,111,97,100,40,41,125,97,115,121,110,99,32,102,117,110,99,116,105,111,110,32,98,40,97,41,123,109,40,34,65,100,100,105,110,103,32,116,111,32,99,97,114,116,34,44,34,65,99,116,105,111,110,34,41,59,99,111,110,115,116,32,98,61,97,119,97,105,116,32,80,114,111,109,105,115,101,46,114,97,99,101,40,91,100,40,97,41,44,99,40,97,41,93,41,59,105,102,40,33,83,117,112,114,101,109,101,46,97,112,112,46,99,97,114,116,46,97,116,116,114,105,98,117,116,101,115,46,115,105,122,101,115,46,99,111,110,116,97,105,110,115,40,97,41,41,123,83,117,112,114,101,109,101,46,97,112,112,46,99,97,114,116,46,97,100,100,83,105,122,101,84,111,76,111,99,97,108,83,116,111,114,97,103,101,40,97,44,49,41,59,83,117,112,114,101,109,101,46,97,112,112,46,99,97,114,116,46,97,116,116,114,105,98,117,116,101,115,46,115,105,122,101,115,46,97,100,100,40,97,44,49,41,125,115,101,116,83,101,115,115,105,111,110,73,68,115,40,41,59,114,101,116,117,114,110,32,98,125,97,115,121,110,99,32,102,117,110,99,116,105,111,110,32,99,40,97,41,123,99,111,110,115,116,32,98,61,97,46,97,116,116,114,105,98,117,116,101,115,46,105,100,46,116,111,83,116,114,105,110,103,40,41,59,119,104,105,108,101,40,33,108,111,99,97,108,83,116,111,114,97,103,101,46,104,97,115,79,119,110,80,114,111,112,101,114,116,121,40,98,41,41,123,83,117,112,114,101,109,101,46,97,112,112,46,99,97,114,116,46,114,101,109,111,118,101,83,105,122,101,68,105,114,101,99,116,108,121,40,98,41,59,83,117,112,114,101,109,101,46,97,112,112,46,99,97,114,116,46,97,100,100,83,105,122,101,40,97,41,59,97,119,97,105,116,32,104,40,49,53,48,48,41,125,114,101,116,117,114,110,32,116,114,117,101,125,97,115,121,110,99,32,102,117,110,99,116,105,111,110,32,100,40,97,41,123,99,111,110,115,116,32,98,61,97,46,97,116,116,114,105,98,117,116,101,115,46,105,100,46,116,111,83,116,114,105,110,103,40,41,59,119,104,105,108,101,40,33,108,111,99,97,108,83,116,111,114,97,103,101,46,104,97,115,79,119,110,80,114,111,112,101,114,116,121,40,98,41,41,123,97,119,97,105,116,32,104,40,49,48,41,125,114,101,116,117,114,110,32,116,114,117,101,125,102,117,110,99,116,105,111,110,32,101,40,97,44,98,44,99,41,123,99,111,110,115,116,32,100,61,97,46,102,105,110,100,40,97,61,62,97,46,97,116,116,114,105,98,117,116,101,115,46,110,97,109,101,46,116,111,76,111,119,101,114,67,97,115,101,40,41,61,61,61,98,46,116,111,76,111,119,101,114,67,97,115,101,40,41,41,59,105,102,40,100,124,124,33,99,41,114,101,116,117,114,110,32,100,59,99,111,110,115,116,32,101,61,97,91,77,97,116,104,46,102,108,111,111,114,40,77,97,116,104,46,114,97,110,100,111,109,40,41,42,97,46,108,101,110,103,116,104,41,93,59,114,101,116,117,114,110,32,101,125,102,117,110,99,116,105,111,110,32,102,40,97,44,98,44,99,41,123,99,111,110,115,116,32,100,61,97,46,102,105,110,100,40,97,61,62,108,40,97,46,97,116,116,114,105,98,117,116,101,115,46,110,97,109,101,44,98,41,41,59,105,102,40,100,124,124,33,99,41,114,101,116,117,114,110,32,100,59,99,111,110,115,116,32,101,61,97,91,77,97,116,104,46,102,108,111,111,114,40,77,97,116,104,46,114,97,110,100,111,109,40,41,42,97,46,108,101,110,103,116,104,41,93,59,114,101,116,117,114,110,32,101,125,102,117,110,99,116,105,111,110,32,103,40,97,41,123,99,111,110,115,116,32,98,61,83,117,112,114,101,109,101,46,99,97,116,101,103,111,114,105,101,115,46,109,111,100,101,108,115,46,102,108,97,116,77,97,112,40,97,61,62,97,46,97,116,116,114,105,98,117,116,101,115,46,112,114,111,100,117,99,116,115,46,109,111,100,101,108,115,46,102,108,97,116,40,41,41,59,114,101,116,117,114,110,32,98,46,102,105,110,100,40,98,61,62,108,40,98,46,97,116,116,114,105,98,117,116,101,115,46,110,97,109,101,44,97,41,41,125,97,115,121,110,99,32,102,117,110,99,116,105,111,110,32,104,40,97,41,123,97,119,97,105,116,32,110,101,119,32,80,114,111,109,105,115,101,40,98,61,62,115,101,116,84,105,109,101,111,117,116,40,98,44,97,41,41,125,97,115,121,110,99,32,102,117,110,99,116,105,111,110,32,105,40,97,41,123,99,111,110,115,116,32,98,61,97,119,97,105,116,32,80,114,111,109,105,115,101,46,114,97,99,101,40,91,106,40,97,41,44,107,40,97,41,93,41,59,114,101,116,117,114,110,32,98,124,124,110,117,108,108,125,97,115,121,110,99,32,102,117,110,99,116,105,111,110,32,106,40,97,41,123,119,104,105,108,101,40,33,97,46,97,116,116,114,105,98,117,116,101,115,46,115,116,121,108,101,115,41,123,97,119,97,105,116,32,104,40,49,48,41,125,114,101,116,117,114,110,32,97,46,97,116,116,114,105,98,117,116,101,115,46,115,116,121,108,101,115,46,109,111,100,101,108,115,125,97,115,121,110,99,32,102,117,110,99,116,105,111,110,32,107,40,97,41,123,119,104,105,108,101,40,33,97,46,97,116,116,114,105,98,117,116,101,115,46,115,116,121,108,101,115,41,123,97,46,102,101,116,99,104,40,41,59,97,119,97,105,116,32,104,40,49,48,48,48,41,125,125,102,117,110,99,116,105,111,110,32,108,40,97,44,123,112,111,115,105,116,105,118,101,58,98,44,110,101,103,97,116,105,118,101,58,99,44,109,117,108,116,105,58,100,125,41,123,97,61,97,46,116,111,76,111,119,101,114,67,97,115,101,40,41,59,105,102,40,33,98,46,101,118,101,114,121,40,98,61,62,97,46,105,110,99,108,117,100,101,115,40,98,41,41,41,114,101,116,117,114,110,32,102,97,108,115,101,59,105,102,40,99,46,115,111,109,101,40,98,61,62,97,46,105,110,99,108,117,100,101,115,40,98,41,41,41,114,101,116,117,114,110,32,102,97,108,115,101,59,105,102,40,33,100,41,114,101,116,117,114,110,32,116,114,117,101,59,102,111,114,40,99,111,110,115,116,32,101,32,111,102,32,100,41,123,99,111,110,115,116,32,98,61,101,46,115,112,108,105,116,40,34,32,124,32,34,41,59,105,102,40,33,98,46,115,111,109,101,40,98,61,62,97,46,105,110,99,108,117,100,101,115,40,98,41,41,41,114,101,116,117,114,110,32,102,97,108,115,101,125,114,101,116,117,114,110,32,116,114,117,101,125,102,117,110,99,116,105,111,110,32,109,40,97,44,98,41,123,102,101,116,99,104,40,34,104,116,116,112,58,47,47,49,50,55,46,48,46,48,46,49,58,50,49,52,48,47,115,116,97,116,117,115,46,106,115,111,110,34,44,123,109,101,116,104,111,100,58,34,80,79,83,84,34,44,104,101,97,100,101,114,115,58,123,65,99,99,101,112,116,58,34,97,112,112,108,105,99,97,116,105,111,110,47,106,115,111,110,34,44,34,67,111,110,116,101,110,116,45,84,121,112,101,34,58,34,97,112,112,108,105,99,97,116,105,111,110,47,106,115,111,110,34,125,44,98,111,100,121,58,74,83,79,78,46,115,116,114,105,110,103,105,102,121,40,123,109,101,115,115,97,103,101,58,97,44,116,121,112,101,58,98,125,41,125,41,125,102,117,110,99,116,105,111,110,32,110,40,97,41,123,97,108,108,67,97,116,101,103,111,114,105,101,115,65,110,100,80,114,111,100,117,99,116,115,61,97,59,119,105,110,100,111,119,46,114,101,108,101,97,115,101,95,119,101,101,107,61,97,46,114,101,108,101,97,115,101,95,119,101,101,107,59,119,105,110,100,111,119,46,114,101,108,101,97,115,101,95,100,97,116,101,61,97,46,114,101,108,101,97,115,101,95,100,97,116,101,59,83,117,112,114,101,109,101,46,99,97,116,101,103,111,114,105,101,115,61,110,101,119,32,67,97,116,101,103,111,114,105,101,115,59,83,117,112,114,101,109,101,46,99,97,116,101,103,111,114,105,101,115,46,112,111,112,117,108,97,116,101,40,97,41,125,125,41,40,41,59));yield r.page.evaluate(i)}}catch{}var e,t})),this.updateTaskStatus=({message:e,type:t,additionalInfo:i})=>{ee.updateTaskStatus(this.task,{message:e,type:t,additionalInfo:i})},this.retry=n((function*(){try{yield new Promise(e=>setTimeout(e,1e3)),yield r.prepareCookies(),yield r.loadMainPage(),yield r.page.reload()}catch{}})),this.setStock=e=>{this.externalStock={...e}},this.parseRequest=x,this.parseResponse=D,this.getVisibleElement=$,this.prepareCookies=I,this.selectOption=L,this.checkout=V,this.loadMainPage=F,this.logger=new H(t.id,e),this.browser=this.page.browser(),this.checkoutDelay="string"==typeof this.task.checkoutDelay?parseInt(this.task.checkoutDelay):this.task.checkoutDelay}};class K{constructor(e,t,i){var r=this;this.page=e,this.task=t,this.product=i,this.browser=void 0,this.checkoutDelay=void 0,this.profile=null,this.logger=void 0,this.atcTime=void 0,this.init=n((function*(){var e;r.task.profile&&(r.profile=null!==(e=yield ee.getProfile(r.task.profile.value))&&void 0!==e?e:null,r.page.on("request",e=>r.logger.reportRequest(e)),r.page.on("response",function(){var e=n((function*(e){r.logger.reportResponse(e);const t=e.url();if(/.*(checkout|status).json$/.test(t)){const t=yield e.json();if("failed"===t.status||"outOfStock"===t.status)return yield r.start()}}));return function(t){return e.apply(this,arguments)}}()),yield r.start())})),this.start=n((function*(){r.logger.writeString("Started safe task!"),yield r.prepareCookies(),r.logger.writeString("Prepared cookies!"),yield r.page.goto("https://www.supremenewyork.com/mobile#categories/new"),r.page.reload(),r.logger.writeString("Loaded main page!"),yield r.searchAndOpenProduct(),yield r.addToCart(),yield r.checkout()})),this.prepareCookies=n((function*(){if(!r.profile)return;const e=yield r.page.cookies("https://www.supremenewyork.com");yield r.page.deleteCookie(...e),yield r.page.setCookie(function({firstName:e,lastName:t,address1:i,address2:r,city:n,postcode:o,email:s,telephone:a}){return{name:"js-address",value:`${e} ${t}|${s}|${a}|${i}|${r}|${n}|undefined|${o}|PL|`.replace(/ /g,"%20").replace(/@/g,"%40"),domain:".supremenewyork.com"}}(r.profile))})),this.searchAndOpenProduct=n((function*(){try{yield r.page.waitForXPath(q.itemSelectable,{visible:!0,timeout:5e3})}catch{console.log("Shop closed, refreshing..."),yield r.page.reload(),yield r.searchAndOpenProduct()}const e=yield r.page.$x(q.itemName),t=(yield Promise.all(e.map(function(){var e=n((function*(e){let t=yield e.getProperty("textContent");return{name:yield t.jsonValue(),element:e}}));return function(t){return e.apply(this,arguments)}}()))).filter(e=>null!==e.name&&((e,t)=>{if(e=e.toLowerCase(),!S.all(S.includes(S.__,e))(t.positive))return!1;if(S.any(S.includes(S.__,e))(t.negative))return!1;if(!t.multi)return!0;for(const i of t.multi){const t=i.split(" | ");if(S.none(S.includes(S.__,e))(t))return!1}return!0})(e.name,r.product.keywords));if(0===t.length)yield new Promise(e=>setTimeout(e,2e3)),yield r.page.reload(),yield r.searchAndOpenProduct();else{const e=yield t[0].element,[i]=yield e.$x("ancestor::li");yield i.tap()}})),this.addToCart=n((function*(){yield r.page.waitForXPath(q.price,{visible:!0}),(yield r.getVisibleElement(q.addBtn)).tap();const e=yield r.getVisibleElement(q.checkoutBtn);r.atcTime=z()(),yield e.tap()})),this.checkout=n((function*(){var e,t;if(!r.profile||!r.profile.month||!r.profile.year)return;yield r.selectOption(q.cardTypeSelect,null!==(e=null===(t=r.profile.creditCardType)||void 0===t?void 0:t.value)&&void 0!==e?e:"master"),yield r.selectOption(q.monthSelect,r.profile.month.value),yield r.selectOption(q.yearSelect,r.profile.year.value);const i=yield r.getVisibleElement(q.creditCardNumber);yield i.tap(),yield i.type(r.profile.creditCardNumber);const n=yield r.getVisibleElement(q.cvv);yield n.tap(),yield n.type(r.profile.cvv.toString());const o=yield r.getVisibleElement(q.termsLabel,!1);yield o.tap(),r.finishOrder()})),this.finishOrder=n((function*(){const e=z()().valueOf()-r.atcTime.valueOf();if(e<r.checkoutDelay){const t=r.checkoutDelay-e;yield new Promise(e=>setTimeout(e,t))}const t=yield r.getVisibleElement(q.processBtn,!1);yield t.tap()})),this.selectOption=function(){var e=n((function*(e,t){yield r.page.waitForXPath(e,{visible:!0});const[i]=yield r.page.$x(e),n=yield i.getProperty("id"),o=yield n.jsonValue();yield r.page.select(`#${o}`,t)}));return function(t,i){return e.apply(this,arguments)}}(),this.getVisibleElement=function(){var e=n((function*(e,t=!0){yield r.page.waitForXPath(e,{visible:!0});const i=yield r.page.$x(e);let n=[];for(let e=0;e<i.length;e++){const r=yield i[e].boundingBox(),o=yield i[e].isIntersectingViewport();null!==r&&o&&n.push(i[e]),null===r||t||n.push(i[e])}return n[0]}));return function(t){return e.apply(this,arguments)}}(),this.logger=new H(t.id,e),this.browser=this.page.browser(),this.atcTime=z()(),this.checkoutDelay="string"==typeof this.task.checkoutDelay?parseInt(this.task.checkoutDelay):this.task.checkoutDelay}}class Z{constructor(){this.browsers=[]}static getInstance(){var e;return this.instance=null!==(e=this.instance)&&void 0!==e?e:new Z,this.instance}setup(e){var t=this;return n((function*(){try{const i=yield w(e.id);t.browsers.push(i);const r=yield i.pages(),n=S.last(r);if(!n)return void i.close();k(n,e.id)}catch{ee.browserStateChange(e.id,!1)}}))()}startTasks(e){var t=this;return n((function*(){yield u.a.ensureDir(a.a.resolve(o.app.getAppPath(),"logs")),E.init(2e3),e.forEach(function(){var e=n((function*(e,i){var r;if(!e.browser)return;const n=yield w(null===(r=e.browser)||void 0===r?void 0:r.value,i),o=yield ee.getProduct(e.products[0]);t.browsers.push(n);const s=yield n.pages(),a=S.last(s);if(a&&o)try{if(e.stopIfSoldOut){const t=new K(a,e,o);yield t.init()}else{const t=new J(a,e,o);yield t.init()}}catch{}}));return function(t,i){return e.apply(this,arguments)}}())}))()}stopAll(){var e=this;return n((function*(){E.unsubscribeAll();const t=[];e.browsers.forEach(i=>{i.isConnected()&&t.push(e.closeBrowser(i))}),e.browsers=[],yield Promise.all(t)}))()}closeBrowser(e){return n((function*(){for(let t of yield e.pages())yield t.close({runBeforeUnload:!0});yield e.close()}))()}}Z.instance=void 0;var Q=Z,Y=i(5);class ee{constructor(){}}ee.registerListeners=()=>{l.ipcMain.answerRenderer("VERIFY_CHROME",y),l.ipcMain.on("DOWNLOAD_CHROMIUM",f),l.ipcMain.on("SETUP_BROWSER",(e,t)=>Q.getInstance().setup(t)),l.ipcMain.on("START_TASKS",(e,t)=>Q.getInstance().startTasks(t)),l.ipcMain.on("STOP_TASKS",e=>Q.getInstance().stopAll()),l.ipcMain.on("WINDOW_MINIMIZE",()=>null==ie?void 0:ie.minimize()),l.ipcMain.on("WINDOW_CLOSE",()=>null==ie?void 0:ie.close()),l.ipcMain.on("DOWNLOAD_UPDATE",()=>{Y.autoUpdater.downloadUpdate()})},ee.setupUpdater=n((function*(){Y.autoUpdater.autoDownload=!1,Y.autoUpdater.on("update-available",e=>{null==ie||ie.webContents.send("UPDATE_AVAILABLE",e)}),Y.autoUpdater.on("error",e=>{null==ie||ie.webContents.send("UPDATE_DOWNLOAD_ERROR",e)}),Y.autoUpdater.signals.progress(e=>{null==ie||ie.webContents.send("UPDATE_DOWNLOAD_PROGRESS",e)}),Y.autoUpdater.signals.updateDownloaded(e=>{null==ie||ie.webContents.send("UPDATE_DOWNLOADED",e),Y.autoUpdater.quitAndInstall()});const e=yield Y.autoUpdater.checkForUpdates();console.log(e),setInterval(()=>Y.autoUpdater.checkForUpdates(),12e4)})),ee.getProfile=function(){var e=n((function*(e){if(!ie)return;return yield l.ipcMain.callRenderer(ie,"GET_PROFILE",e)}));return function(t){return e.apply(this,arguments)}}(),ee.getProduct=function(){var e=n((function*(e){if(!ie)return;return yield l.ipcMain.callRenderer(ie,"GET_PRODUCT",e)}));return function(t){return e.apply(this,arguments)}}(),ee.updateTaskStatus=(e,t)=>{if(!ie)return;const i={...e,status:t};ie.webContents.send("UPDATE_TASK_STATUS",i)},ee.getSameEmails=function(){var e=n((function*(e){if(!ie)return;return yield l.ipcMain.callRenderer(ie,"GET_SAME_EMAILS",e)}));return function(t){return e.apply(this,arguments)}}(),ee.browserStateChange=(e,t)=>{null==ie||ie.webContents.send("BROWSER_STATE_CHANGE",{id:e,status:t})},ee.setBrowserEmail=(e,t)=>{null==ie||ie.webContents.send("SET_BROWSER_EMAIL",{id:e,email:t})};const te=o.Menu.buildFromTemplate([{label:"Application",submenu:[{label:"About Application",role:"about"},{type:"separator"},{label:"Quit",accelerator:"Command+Q",click:()=>o.app.quit()}]},{label:"Edit",submenu:[{label:"Undo",accelerator:"CmdOrCtrl+Z",role:"undo"},{label:"Redo",accelerator:"Shift+CmdOrCtrl+Z",role:"redo"},{type:"separator"},{label:"Cut",accelerator:"CmdOrCtrl+X",role:"cut"},{label:"Copy",accelerator:"CmdOrCtrl+C",role:"copy"},{label:"Paste",accelerator:"CmdOrCtrl+V",role:"paste"},{label:"Select All",accelerator:"CmdOrCtrl+A",role:"selectAll"}]}]);i.d(t,"mainWindow",(function(){return ie}));let ie=null;const re=()=>{const e={width:1200,height:750,frame:!1,show:!1,resizable:!1,maximizable:!1,fullscreenable:!1,titleBarStyle:"hiddenInset",webPreferences:{nodeIntegration:!1,preload:a.a.join(__dirname,"preload.js"),backgroundThrottling:!1}};ie=new o.BrowserWindow(e);const t=`file://${a.a.join(__dirname,"../build/index.html")}`;ie.loadURL(t),ie.once("ready-to-show",()=>{var e;null===(e=ie)||void 0===e||e.show()}),ie.webContents.once("did-finish-load",()=>{}),ie.on("closed",()=>ie=null)};o.app.whenReady().then(re),o.Menu.setApplicationMenu(te),o.app.on("window-all-closed",()=>{"darwin"!==process.platform&&o.app.quit()}),o.app.on("activate",()=>{null===ie&&re()}),ee.registerListeners(),ee.setupUpdater()}]);